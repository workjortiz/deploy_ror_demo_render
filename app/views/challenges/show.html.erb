<script>
  function cancelAction(){
    document.getElementById('myModal').style.display = 'none';
  }

  function openModalAction(){
    document.getElementById('myModal').style.display = 'block';
  }
  
  function confirmAction(id){
    console.log("id: "+id);

    const postData = { id: id };
    $.ajax({
        url: '/api/v1/challenges/delete',
        type: 'POST',
        data: JSON.stringify(postData),
        contentType: 'application/json',
        success: function(response){
          if(response.success){            
            window.location.href = '/challenges/delete/success';
          }
        },
        error: function(xhr){
          console.log("ERROR: "+xhr.responseJSON);
        }
    });

    document.getElementById('myModal').style.display = 'none';
  }

</script>
<p style="color: green"><%= notice %></p>

<h3>Tu Resultado</h3>
<p>Hola <%= @challenge.name %> a continuación el resultado de tu procesamiento de información. Puedes copiarlo o usar un REST GET con la siguiente (<a href="/api/v1/challenges/show?token=<%= @challenge.token %>" target="_blank">Link</a>) para obtener el JSON</p>

<div class='json-box'>
  <% begin %>
  <pre><%= JSON.pretty_generate(JSON.parse(@challenge.parsing_content.to_s)) %></pre>
  <% rescue %>
    <p>Opps!!! este registro esta mal diseñado</p>
  <% end %>
</div>

<div>
  <%= link_to "Back to challenges", challenges_path %>
  <button onclick="openModalAction()">Delete</button>
</div>


<!-- Delete Confirmation Modal -->
<div id="myModal" class="float-modal">
  <div  class="content-float-modal">
    <p><%= t('dialog.confirm.delete_item') %></p>
    <button onclick="confirmAction(<%= @challenge.id %>)"><%= t('words.confirm') %></button>
    <button onclick="cancelAction()"><%= t('words.cancel') %></button>
  </div>
</div>